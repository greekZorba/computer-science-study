# 제 9강 하드웨어 연산 
## 1. 산술 연산 
### 1.1 산술연산의 정의 
- 산술 연산은 덧셈, 뺄셈, 곱셈, 나눗셈의 사친역산의 계산을 하는 것
- 컴퓨터는 레지스터, ALU를 이용해 연산 

## 2. MIPS
### 2.1 MIPS 산술명령어 
- MIPS 산술명령어는 반드시 한 종류의 연산만 지시 (예를 들면, 사칙연산 중 덧셈만 사용)
- MIPS 산술명령어는 항상 변수 세개를 갖는 형식 
- 피연산자가 반드시 3개인 이유 : 간단하게 설계하기 위해서는 규칙적인 것이 좋음. <br>
간단하지만 최적화된 명령어 실행을 위해서 

- MIPS 산술명령어를 통해 b,c,d,e의 합을 a에 넣는 경우 <br>
1) add a,b,c -> b와 c를 더하여 a에 저장 -> a = b+c
1) add a,a,d -> a와 d를 더하여 a에 저장 -> a = a+d
1) add a,a,e -> a와 e를 더하여 a에 저장 -> a = a+e

### 2.2 MIPS 레지스터 
- 연산을 위하여 MIPS 명령어구조에서 제공하는 레지스터 
- 레지스터는 **컴퓨터가 사용하는 변수**라고 이해하면 편함. 

### 2.3 스택프레임 
- 함수가 실행될 때마다 자신만의 고유한 stack 영역을 가질 수 있다. 
- 함수의 스택프레임 시작점은 fp가 가리킨다. 
- 함수의 종료시에 해제되고 리턴 주소로 복귀한다. 

| 이름 | 레지스터 번호 | 용도 |
|---|:---:|:---:| 
| $zero | $0 | 항상 0을 출력하는 레지스터. 이 레지스터의 값을 바꿀 수 없다. |
| $v- ~ $v1 | $2 ~ $3 | 함수로부터 반환된 값을 저장하는 레지스터 |
| $t0 ~ $t7 | $8 ~ $15 | 어셈블러나 어셈블리 언어에서 값을 임시로 저장할 때 사용하는 레지스터 | 
| $s0 ~ $s7 | $16 ~ $23 | 오랫동안 지속되는 값을 저장할 때 사용하는 레지스터 | 
| $sp | $29 | 스택 포인터의 값을 저장하는 레지스터 |
| $fp | $30 | 프레임 포인터의 값을 저장하는 레지스터 | 
| $ra | $31 | 주소 반환값을 저장하는 레지스터 |


```c
    int add(int a, int b) {
        return a+b;
    }

    int main() {

        printf("%d", add(3, 4));
        printf("Hello World!₩n");

        return 0;
    }
```  

### add 스택프레임 <br>
| 값  |  메모리 주소  |
|---|:---:|
|sp -> 4 | 0x08 |
| &nbsp;&nbsp;&nbsp;&nbsp;  -> 3 | 0x04 |
|fp -> return 주소 | 0x00 |

- int형은 4byte이므로 총 8byte 이동 
- add(4+3)의 연산을 수행하고 그 결과를 **임시공간**에 저장했다가 그 임시공간의 데이터를 **V레지스터**에 저장 
- V레지스터에 값을 저장하고(add 연산 후) 다시 기존의 주소값으로 돌아와야 하는데 이때 return 주소를 가지고 있는 레지스터가 **ra**이다. 

### 2.4 고급언어와의 관계 
- A = B + C;
- D = A - E;
- A ~ E는 $s1 ~ $s5에 저장되어있다고 가정. <u>대부분 s 레지스터에 변수가 저장</u>
- add $s1, $s2, $s3 
- sub $s4, $s1, $s5 